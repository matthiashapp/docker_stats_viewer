# Docker Stats Monitor

A Go-based web application for collecting, analyzing, and visualizing Docker container statistics over time. This tool provides historical analysis of container performance metrics including CPU usage, memory consumption, network I/O, and more.

## Features

- **Automated Data Collection**: Periodically collects Docker stats from remote servers via SSH
- **Web Dashboard**: Interactive HTML interface for viewing current and historical stats
- **Container Analysis**: Detailed historical analysis for individual containers
- **Summary Reports**: Aggregated statistics across all containers and time periods
- **Real-time Updates**: Automatic refresh of stats data every 5 minutes
- **Search and Filtering**: Easy filtering by container name
- **Performance Metrics**: CPU, memory, network I/O, block I/O, and process count tracking

## Project Structure

```
docker_stats/
├── main.go              # Main application server
├── run.sh              # Data collection script
├── go.mod              # Go module definition
├── stats/              # Directory containing collected JSON stats files
│   ├── 2025-08-05_08-57-16_docker_stats.json
│   ├── 2025-08-05_09-14-39_docker_stats.json
│   └── ...
└── README.md           # This file
```

## Prerequisites

- **Go 1.24.5+** - For running the web server
- **SSH access** - To the target Docker host(s)
- **Docker** - Running on the target server
- **Bash** - For the data collection script

## Installation

1. **Clone or download the project**:

   ```bash
   git clone <repository-url>
   cd docker_stats
   ```

2. **Configure SSH access**:

   - Update the `TARGET_SERVER` variable in `run.sh` to point to your Docker host
   - Ensure SSH key-based authentication is configured for the target server

3. **Install Go dependencies**:

   ```bash
   go mod tidy
   ```

4. **Create stats directory** (if not exists):
   ```bash
   mkdir -p stats
   ```

## Usage

### Manual Data Collection

Run the data collection script manually:

```bash
./run.sh
```

This will:

- Connect to the configured server via SSH
- Execute `docker stats --no-stream --format '{{json .}}'`
- Save the output to a timestamped JSON file in the `stats/` directory

### Start the Web Server

```bash
go run main.go
```

The server will start on `http://localhost:8080`

### Accessing the Dashboard

1. **Main Dashboard** (`http://localhost:8080`):

   - View stats from any collected file
   - Sort and filter containers
   - Click container IDs for detailed analysis

2. **Container Details** (`http://localhost:8080/container/{container_id}`):

   - Historical timeline for a specific container
   - Statistical summaries (avg, min, max)
   - Detailed metrics table

3. **Summary Report** (`http://localhost:8080/summary`):
   - Aggregated statistics across all containers
   - Performance rankings
   - Overall system insights

## Configuration

### SSH Target Server

Edit `run.sh` to configure your Docker host:

```bash
TARGET_SERVER="your-server-name"  # SSH alias or hostname
```

### Data Collection Interval

The application automatically runs `run.sh` every 5 minutes. To modify this interval, edit the ticker duration in `main.go`:

```go
ticker := time.NewTicker(5 * time.Minute)  // Change as needed
```

### Server Port

To change the default port (8080), modify the port variable in `main.go`:

```go
port := "8080"  // Change to desired port
```

## Data Format

The application expects JSON files in the following format (generated by Docker stats):

```json
{
  "BlockIO": "0B / 0B",
  "CPUPerc": "0.01%",
  "Container": "container_name",
  "ID": "container_id",
  "MemPerc": "0.04%",
  "MemUsage": "1.488MiB / 8.192GiB",
  "Name": "container_name",
  "NetIO": "0B / 0B",
  "PIDs": "1"
}
```

## API Endpoints

- `GET /` - Main dashboard
- `GET /container/{id}` - Container details page
- `GET /summary` - Summary report page
- `GET /api/container/{id}` - JSON API for container data

## Features in Detail

### Performance Metrics

- **CPU Usage**: Percentage utilization with color-coded indicators
- **Memory Usage**: Both percentage and absolute values
- **Network I/O**: Inbound/outbound network traffic
- **Block I/O**: Disk read/write operations
- **Process Count**: Number of running processes

### Visual Indicators

- **High Usage** (>80%): Red highlighting
- **Medium Usage** (50-80%): Yellow highlighting
- **Low Usage** (<50%): Green highlighting

### Data Analysis

- Statistical calculations (min, max, average)
- Historical trending
- Performance ranking
- Time-series analysis

## Troubleshooting

### No Data Collected

- Verify SSH connectivity to target server
- Ensure Docker is running on target server
- Check that the `stats/` directory is writable

### Server Won't Start

- Verify Go installation and version
- Check that port 8080 is available
- Ensure stats files exist in the `stats/` directory

### Permission Issues

- Make sure `run.sh` is executable: `chmod +x run.sh`
- Verify SSH key permissions and configuration

## Development

### Adding New Metrics

1. Update the `DockerStat` struct in `main.go`
2. Modify the HTML templates to display new fields
3. Update parsing logic if needed

### Customizing the UI

- Modify the HTML templates embedded in `main.go`
- Adjust CSS styles for different visual themes
- Add new JavaScript functionality for interactivity

## Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Test thoroughly
5. Submit a pull request

## License

This project is provided as-is for monitoring Docker container performance. Modify and distribute as needed for your infrastructure monitoring requirements.
